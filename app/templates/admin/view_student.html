{% extends 'admin/admin_base.html' %}
{% block content %}
<div class="row">
    <div class="col-12">
        <div class="page-title-box">
            <div class="page-title-right">
                <ol class="breadcrumb m-0">
                    <li class="breadcrumb-item"><a href="javascript: void(0);">Academic Admission</a></li>
                    <li class="breadcrumb-item active">View Students</li>
                </ol>
            </div>
            <h4 class="page-title">All Student Details</h4>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <div class="row mb-2">
                    <div class="col-sm-4">
                        <a href="{{ url_for('register_student_page')}}" class="btn btn-dark mb-2"><i
                                class="mdi mdi-plus-circle me-2"></i> Add
                            Student</a>
                    </div>
                    <div class="col-sm-8">
                        <div class="text-sm-end">
                            <button type="button" class="btn btn-success mb-2 me-1"><i class="mdi mdi-cog"></i></button>
                            <a href="#" class="btn btn-light mb-2" onclick="window.print()">Export</a>
                        </div>
                    </div>
                </div>
                <div class="table-responsive">
                    <table id="basic-datatable" class="table dt-responsive nowrap w-100">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Student Name</th>
                                <th>Phone</th>
                                <th>Address</th>
                                <th>Date of Birth</th>
                                <th>Guide Number</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if students%}
                            {%for student in students%}
                            <tr id="student-row-{{ student.student_id }}">
                                <td>HU000{{ student.student_id }}</td>
                                <td class="table-user">
                                    <a href="#" class="text-body fw-semibold">{{ student.f_name }} {{ student.s_name }}
                                        {{ student.l_name }}</a>
                                </td>
                                <td>{{ student.phone }}</td>
                                <td>{{ student.address }}</td>
                                <td>{{ student.date_of_birth }}</td>
                                <td>{{ student.mother_phone }}</td>
                                <td class="d-flex">
                                    <div class="dropdown dropstart">
                                        <a href="#" class="action-icon view-icon" data-bs-toggle="dropdown">
                                            <i class="mdi mdi-eye status-icon"></i>
                                        </a>
                                        <ul class="dropdown-menu p-2 shadow" style="min-width: 220px;">
                                            <li>
                                                <form>
                                                    <h5>Change student status</h5>
                                                    <select class="form-select">
                                                        <option value="" selected disabled>Select Option</option>
                                                        <option value="Active">Active</option>
                                                        <option value="Inactive">Inactive</option>
                                                        <option value="Graduated">Graduated</option>
                                                        <option value="Suspended">Suspended</option>
                                                    </select>
                                                    <div class="mt-3 d-grid">
                                                        <button type="button" class="btn btn-success rounded-3"
                                                            id="saveStatusButton">
                                                            <span class="spinner-border spinner-border-sm me-1"
                                                                role="status" aria-hidden="true" id="spinner"
                                                                style="display: none;"></span>
                                                            Save
                                                        </button>
                                                    </div>
                                                </form>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="dropdown dropstart">
                                        <a href="#" class="action-icon update-icon" data-bs-toggle="dropdown">
                                            <i class="mdi mdi-square-edit-outline"></i>
                                        </a>
                                        <ul class="dropdown-menu p-3" style="min-width: 250px;" data-bs-auto-close="outside">
                                            <!-- Change Class Button -->
                                            <li>
                                                <button class="dropdown-item d-flex justify-content-between align-items-center toggle-btn" data-target="#changeClassForm">
                                                    Change Class
                                                    <i class="mdi mdi-chevron-down"></i>
                                                </button>
                                            </li>
                                            <li>
                                                <div id="changeClassForm" class="collapse">
                                                    <form>
                                                        <label class="form-label mt-2">Select Class</label>
                                                        <select class="form-select">
                                                            <option value="" disabled selected>Select Class</option>
                                                            <option value="Class A">Class A</option>
                                                            <option value="Class B">Class B</option>
                                                            <option value="Class C">Class C</option>
                                                        </select>
                                                        <div class="d-grid mt-2">
                                                            <button type="button" class="btn btn-success">Save</button>
                                                        </div>
                                                    </form>
                                                </div>
                                            </li>
                                    
                                            <li>
                                                <hr class="dropdown-divider">
                                            </li>
                                    
                                            <!-- Change Password Button -->
                                            <li>
                                                <button class="dropdown-item d-flex justify-content-between align-items-center toggle-btn" data-target="#changePasswordForm">
                                                    Change Password
                                                    <i class="mdi mdi-chevron-down"></i>
                                                </button>
                                            </li>
                                            <li>
                                                <div id="changePasswordForm" class="collapse">
                                                    <form>
                                                        <label class="form-label mt-2">New Password</label>
                                                        <input type="password" class="form-control" placeholder="Enter new password">
                                                        
                                                        <label class="form-label mt-2">Confirm Password</label>
                                                        <input type="password" class="form-control" placeholder="Confirm password">
                                                        
                                                        <div class="d-grid mt-2">
                                                            <button type="button" class="btn btn-success">Save</button>
                                                        </div>
                                                    </form>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>

                                </td>
                            </tr>

                            {%endfor%}
                            {%endif%}

                        </tbody>

                    </table>
                </div>
            </div> <!-- end card-body-->
        </div> <!-- end card-->
    </div> <!-- end col -->
</div>
<script>
    document.querySelectorAll('.toggle-btn').forEach(button => {
        button.addEventListener('click', function (event) {
            event.stopPropagation(); // Prevent dropdown from closing
            
            let target = document.querySelector(this.getAttribute('data-target'));
            let allCollapses = document.querySelectorAll('.collapse');

            allCollapses.forEach(collapse => {
                if (collapse !== target) {
                    collapse.classList.remove('show'); // Hide other sections
                }
            });

            target.classList.toggle('show'); // Toggle the selected one
        });
    });
</script>
{% endblock %}